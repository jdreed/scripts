#!/bin/sh
#
# This is undoubtedly a bad idea

if ! [ -r /debathena/debug.log ]; then
  echo "I can't read /debathena/debug.log and therefore can't send mail."
  exit 0
fi

outgoing=18.7.22.104

echo -n "Enter your full name: "
read NAME
echo -n "Enter your MIT e-mail address: "
read ADDR

echo "Sending mail..."
msg="HELO mit.edu
MAIL FROM: <errors@mit.edu>
RCPT TO: <release-team@mit.edu>
DATA
To: release-team@mit.edu
From: errors@mit.edu
Subject: Stage 1 install failure log from $ADDR

Contact name: $NAME
Contact addr: $ADDR

Debug log:
$(cat /debathena/debug.log)
.
QUIT" 

if echo "$msg" | nc -w 5 $outgoing 25; then
  echo "Mail sent."
else
  echo "Couldn't send mail for some reason."
fi
  
