#!/bin/sh

# End stale schroot sessions

CHROOTS=$(schroot -la | awk -F: '$1=="session" { print $2; }')
if [ -z "$CHROOTS" ]; then
    echo "No chroot sessions, nothing to do."
    exit 0
fi
echo "Found these chroot sessions:"
echo $CHROOTS
echo -n "End them? (y/n) "
read ans
[ "$ans" = "y" ] || exit 0
set -e
for c in $CHROOTS; do
    echo "Ending $c"
    schroot -c "$c" -e
done
set +e
exit 0

